# -*- coding: utf-8 -*-
"""FInalImagenetwithResnet50.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/14EnZIb8bUUgP-_C5BDIwVJ4B6ooN6jPN
"""

#lineone:Resnet50 model is used to classify a image (given:url of a image)-(keras)
#http://image-net.org/about-stats
#https://arxiv.org/abs/1512.03385
#below code has been tested and executed only in colab.research.google.com .Please make sure you have enabled GPU from notebook settings before execution

#make sure you are importing preprocess_input and decode_predictions from resnet50 model
from keras.applications.resnet50 import ResNet50
from keras.preprocessing import image
from keras.applications.resnet50 import preprocess_input,decode_predictions
import numpy as np

#For visualising picture
from matplotlib import pyplot as plt
# %matplotlib inline

model=ResNet50(weights='imagenet',include_top=True)

#image is loaded from url
#you can use imread to load loacally 
from urllib.request import urlopen

#url of the image is stored in url_link1
url_link1=urlopen("https://secure.img1-fg.wfcdn.com/im/60243122/resize-h800%5Ecompr-r85/4037/40372281/Corona+Extendable+Dining+Table.jpg")

#(224,224) is the target size of resnet50 model
img1=image.load_img(url_link1,target_size=(224,224))

#visuvalising input image
plt.imshow(img1)

#preprocessing input image
x1=image.img_to_array(img1)
x1=np.expand_dims(x1,axis=0)
x1=preprocess_input(x1)

#input is provided to model to predict the class
pred1=model.predict(x1)

#decode_predictions decodes the values of pred1 and provides the output
print("predictions:",decode_predictions(pred1,top=4)[0])

#You can classify another image like this
#url_link2=urlopen("https://razzonline.com/wp-content/uploads/2017/07/an-elephant-.jpg")

#img2=image.load_img(url_link2,target_size=(224,224))

#plt.imshow(img2)

#x1=image.img_to_array(img2)
#x1=np.expand_dims(x1,axis=0)
#x1=preprocess_input(x1)

#preds2=model.predict(x1)

#print('preditedme:',decode_predictions(preds2,top=3)[0])